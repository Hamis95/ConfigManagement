# Harjoitus 4


**a)**


Hei komento! Tee järjestelmään uusi "hei maailma" -komento ja asenna se orjille Saltilla.


Aloitan tehtävän tekemällä bash scriptin, jonka nimeäin "helloworld.sh"

Sisälle teen yksinkertaisen scriptin;
```
  #!/bin/bash
  echo "Hello World!"
  
```
  
 tämän jälkeen teen /srv/salt kansioon uuden kansion nimeltään "h4". Tänne lisään init.sls tiedoston.
 
 Tämän jälkeen kopioin helloworld.sh tiedoston h4 kansioon ja alan muokkaamaan init.sls tiedostoa.
 
``` 
  /usr/local/bin/helloworld.sh:
    file.managed:
      - source: salt://h4/helloworld.sh
      - mode: 755
```

Tämä sls tiedosto kopioi helloworld.sh tiedoston haluttuun minioniin ja tekee siitä suortitettavan kenelle vain käyttäjälle.

Tämän jälkeen juoksen init.sls tiedoston saltilla ``` sudo salt 'henri' state.apply h4 ```

Käsky onnistui ja tiedosto kopioitui minionille. Katson vielä minionilta onko tiedosto siellä ja ovatko sen käyttöoikeudet konffattu oikein.

![script1](https://user-images.githubusercontent.com/64984528/116258433-9fe0ea00-a77d-11eb-8911-da700bf31376.png)


Kuten näkyy niin vain omistajalla on oikeus muokata tiedostoa, mutta kuka vain käyttäjä voi suorittaa scriptin.

[lähde](https://www.taniarascia.com/how-to-create-and-use-bash-scripts/)


**b)**

whatsup.sh. Tee järjestelmään uusi komento, joka kertoo ajankohtaisia tietoja; asenna se orjille.

Tämän scriptin teen suoraan omaan /srv/salt/bins/bin kansioon, jotta se siirtyy minionille kun teen "script" käskyn.

Tämä toimii file.recourse toiminnolla, jolloin script kansion init.sls tiedostoon on konfattu, että masterin bins kansio kopioituu halutun minionin.
init.sls sisältö:
```
/usr/loval/bin/:
  file.recourse:
    - source: salt://bins/bin/
    - file_mode: 755

```

joten siirryn /srv/salt/bins/bin kansioon ja teen scriptin suoraan sinne

```sudo nano timedate.sh```
sen jälkeen oikeudet kuntoon käskyllä ```sudo chmod 755 timedate.sh```

sisälle:

```
!#/bin/bash

date=$(date +%d_%m_%y)
time=$(time +%T)
echo "the date is $date and time is $time"
```

![script2](https://user-images.githubusercontent.com/64984528/116267143-d110e880-a784-11eb-88f3-8c5955bb62e2.png)

scripti toimii.


seuraavaksi juoksen käskyn ```sudo salt 'henri' state.apply script```



![script3](https://user-images.githubusercontent.com/64984528/116267428-13d2c080-a785-11eb-8489-4473864a0cdf.png)


Käsky toimi ja mennään vielä tarkistamaan, että tiedosto on oikeassa paikassa ja sen voi suorittaa.


![script4](https://user-images.githubusercontent.com/64984528/116267650-4977a980-a785-11eb-9b28-01363e55f836.png)

tiedosto on oikeassa paikkaa ja sitä juoksemalla tulostuu aika ja päivämäärä.

[lähde](https://www.cyberciti.biz/faq/linux-unix-formatting-dates-for-display/)

**c)**

 hello.py. Tee järjestelmään uusi komento Pythonilla ja asenna se orjille.
 
 Tehdään hello.py niminen tiedosto taas samaan /srv/salt/bins/bin kansioon, jotta homma helpottuu.
 
 ```sudo nano hello.py```
 
 sisälle:
 
 ```
 #!/usr/bin/python3
 
 print("Hei Henri")
 ```
 
sitten muutetaan tiedoston oikeude käskyllä ```sudo chmod 755 hello.py```
 
ja juostaan se paikallisesti.
```./hello.py```

tulostuu: Hei Henri

skripti toimii!

sitten vain juostaan taas salt state script ´´´ sudo salt 'henri' state.apply script ´´´

![script5](https://user-images.githubusercontent.com/64984528/116268941-72e50500-a786-11eb-9f61-91a5bc2eff7a.png)


ja taas tarkastetaan minionista onko kaikki paikallaan

![script6](https://user-images.githubusercontent.com/64984528/116269119-9ad46880-a786-11eb-8655-a414f78b831a.png)

homma toimii kuin pitää

[lähde](https://terokarvinen.com/2021/configuration-management-systems-palvelinten-hallinta-ict4tn022-spring-2021/)














